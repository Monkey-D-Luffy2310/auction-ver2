<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/home}">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Nạp tiền</title>
</head>

<body>
    <div layout:fragment="content">
        <div class="dg-content">
            <div class="dg-wallet">
                <div class="dg-wallet-left">
                    <div class="dg-wallet-content">
                        <form onSubmit="getGiftCode()" id="payment">
                            <div class="page-title">Nạp tiền</div>
                            <div class="dg-wallet-method" id="accordion">
                                <div class="card">
                                    <div class="dg-wallet-method-giftcode">
                                        <input type="radio" name="method" id="giftcode" checked>
                                        <label for="giftcode" data-toggle="collapse" data-target="#collapseOne"
                                            aria-expanded="true" aria-controls="collapseOne">Nạp tiền bằng
                                            giftcode</label>
                                    </div>
                                    <div id="collapseOne" class="collapse show" data-parent="#accordion">
                                        <div class="payment-method-wrapper">
                                            <div class="payment-method-content">
                                                <div class="input-giftcode d-flex align-items-center">
                                                    <div class="input-giftcode-title">Nhập giftcode tại đây:</div>
                                                    <div class="giftcode">
                                                        <input type="text" id="giftcodeInput" class="form-control"
                                                            placeholder="P322-33PE-FBUG-0Z6G-86P6">
                                                    </div>
                                                </div>
                                                <div class="AlertChange mt-4 text-center"></div>
                                                <div class="your-giftcode">
                                                    <div class="your-giftcode-title">Giftcode của bạn</div>
                                                    <div class="image-giftcode">
                                                        <div>
                                                            <img src="/images/ac-img/giftcode-1.svg" alt="">
                                                        </div>
                                                        <div>
                                                            <img src="/images/ac-img/giftcode-2.svg" alt="">
                                                        </div>
                                                        <div>
                                                            <img src="/images/ac-img/giftcode-3.svg" alt="">
                                                        </div>
                                                        <div class="d-flex align-items-center load-more font-italic ">
                                                            <a href="">Xem thêm</a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="received-giftcode">
                                                    <a href="">Nhận giftcode ở đâu?</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="dg-wallet-method-bank" id="headingTwo">
                                        <input type="radio" name="method" id="bank">
                                        <label for="bank" data-toggle="collapse" data-target="#collapseTwo"
                                            aria-expanded="false" aria-controls="collapseTwo">Nạp tiền qua tài khoản
                                            ngân hàng</label>
                                    </div>
                                    <div id="collapseTwo" class="collapse" data-parent="#accordion">
                                        <div class="payment-method-wrapper">
                                            <div class="payment-method-content">
                                                <div class="bank-branch d-flex align-items-center bank">
                                                    <span>Tên ngân hàng:</span>
                                                    <input type="text" class="form-control" id="bankName" disabled>
                                                </div>
                                                <div class="bank-account-number d-flex align-items-center bank">
                                                    <span>Số tài khoản:</span>
                                                    <div class="d-flex copy-wrapper">
                                                        <input type="text" id="account-number"
                                                            class="copy-input form-control" disabled>
                                                        <div class="image-copy-input align-items-center d-flex justify-content-center"
                                                            onclick="copyToClipboard('#account-number')">
                                                            <img src="/images/ac-img/copy.svg" alt="">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="bank-account-name d-flex align-items-center bank">
                                                    <span>Tên tài khoản:</span>
                                                    <input type="text" id="account-name" class="form-control" disabled>
                                                </div>
                                                <div class="note d-flex align-items-center bank">
                                                    <span>Nội dung chuyển khoản:</span>
                                                    <div class="d-flex copy-wrapper">
                                                        <input type="text" id="note" class="copy-input form-control"
                                                            disabled>
                                                        <div class="image-copy-input align-items-center d-flex justify-content-center"
                                                            data-id="note" onclick="copyToClipboard('#note')">
                                                            <img src="/images/ac-img/copy.svg" alt="">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="error-wrapper">
                                                    <span></span>
                                                    <div class="">
                                                        <div class="error-content">
                                                            <div><img src="/images/ac-img/error.svg" alt=""></div>
                                                            <div class="error-content-title">
                                                                Vui lòng ghi chính xác nội dung chuyển khoản để hệ thống
                                                                có
                                                                thể
                                                                xử lý giao dịch chính xác!
                                                            </div>
                                                        </div>
                                                        <div class="error-content">
                                                            <div><img src="/images/ac-img/error.svg" alt=""></div>
                                                            <div class="error-content-title">
                                                                Vui lòng phân biệt <span>chữ o (thấp)</span> và
                                                                <span>số 0 (cao)</span> khi điền nội dung chuyển tiền!
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="copy-nofi mt-4 text-center"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="dg-wallet-method-ac-wallet" id="headingThree">
                                        <input type="radio" name="method" id="ac-wallet">
                                        <label for="ac-wallet" data-toggle="collapse" data-target="#collapseThree"
                                            aria-expanded="false" aria-controls="collapseThree">Nạp tiền bằng ví điện tử
                                            AC Wallet</label>
                                    </div>
                                    <div id="collapseThree" class="collapse" data-parent="#accordion">
                                        <div class="payment-method-wrapper">
                                            <div class="payment-method-content">
                                                <div class="ac-wallet-wallet-address">Địa chỉ ví VNDT</div>
                                                <div class="ac-wallet-wallet-qr">
                                                    <img id="qrcode-img" alt="" style="border-radius:8px" />
                                                </div>
                                                <div class="ac-wallet-copy-input">
                                                    <input type="text" id="walletAddress" class="form-control" disabled>
                                                    <div class="d-flex justify-content-center align-items-center image-copy-input"
                                                        data-id="walletAddress"
                                                        onclick="copyToClipboard('#walletAddress')">
                                                        <div></div>
                                                        <img src="/images/ac-img/copy.svg" alt="">
                                                    </div>
                                                </div>
                                                <div
                                                    class="ac-wallet-error-wrapper d-flex justify-content-center align-items-center">
                                                    <div class="ac-wallet-error-content">
                                                        <div><img src="/images/ac-img/error.svg" alt=""></div>
                                                        <div class="ac-wallet-error-content-title">
                                                            VNDT sẽ hiển thị trên Ví của bạn sau từ 5-10p kể từ khi
                                                            chúng
                                                            tôi nhận được khoản tiền gửi. Vui lòng kiên nhẫn và liên hệ
                                                            với
                                                            chúng tôi để được hỗ trợ.
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="copy-nofi mt-4 text-center"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="btn-payment">
                                <div class="submit-loading text-center" style="position: relative;"></div>
                                <button type="submit" class="btn btn-giftcode text-center" form="payment" style="position: relative;">Tiếp tục</button>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="dg-wallet-right">
                    <div class="instruction-deposit d-flex align-items-center" data-toggle="collapse"
                        data-target="#dg-wallet-instruction" aria-expanded="true">
                        <div>
                            Hướng dẫn nạp tiền
                        </div>
                        <img src="/images/ac-img/down.svg" alt="" width="12px">
                    </div>
                    <div class=" collapse show" id="dg-wallet-instruction">
                        <div class="dg-wallet-instruction-wrapper">
                            <div class="dg-wallet-instruction">
                                <div class="dg-wallet-title">Hướng dẫn nạp tiền bằng giftcode</div>
                                <div class="dg-wallet-video">
                                    <!-- <iframe src="https://www.youtube.com/embed/twoT6hfDF0M"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                            allowfullscreen></iframe> -->
                                </div>
                            </div>
                            <!-- <div class="dg-wallet-instruction">
                                <div class="dg-wallet-title">Hướng dẫn nạp tiền qua ngân hàng</div>
                                <div class="dg-wallet-video">
                                    <iframe src="https://www.youtube.com/embed/twoT6hfDF0M"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                            allowfullscreen></iframe>
                                </div>
                            </div>
                            <div class="dg-wallet-instruction">
                                <div class="dg-wallet-title">Hướng dẫn nạp tiền bằng ví AC Wallet</div>
                                <div class="dg-wallet-video">
                                    <iframe src="https://www.youtube.com/embed/twoT6hfDF0M"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                            allowfullscreen></iframe>
                                </div>
                            </div> -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>
<script th:inline="javascript">
    /*[+
    let id = [[${user.id}]];
    let walletAddress = [[${user.walletAddress}]];
    +]*/
    var bankData;
    var hexString = (id + 1000).toString(16);
    $("#note").val('ACA' + hexString.toUpperCase());
    $("#qrcode-img").attr("src", "https://chart.googleapis.com/chart?chs=270x270&cht=qr&chl=" + walletAddress + "&choe=UTF-8");
    $('#walletAddress').val(walletAddress);
    fetch('/wallet/deposit-bank', {
        method: 'GET'
    })
        .then(res => res.json())
        .then(results => {
            bankData = results[0];
            $('#bankName').val(bankData.bankName);
            $('#account-number').val(bankData.accountNumber);
            $('#account-name').val(bankData.accountName);
        });
    function getGiftCode() {
        event.preventDefault();
        if (giftcodeInput.value == "") {
            $(".AlertChange").addClass("alert alert-danger");
            $(".AlertChange").html('Vui lòng nhập giftcode!!!');
            $(".AlertChange").fadeIn('slow');
            setTimeout(() => $(".AlertChange").fadeOut('slow'), 4000);
        }
        else {
            $('.submit-loading').addClass('spinning');
            $('.btn-giftcode').hide();
            fetch('/giftcode/enter/' + giftcodeInput.value, {
                method: 'GET'
            })
                .then(res => {
                    return res.text()
                }
                )
                .then(results => {
                    $('.btn-giftcode').show();
                    $('.submit-loading').removeClass('spinning');
                    console.log(results);
                    if (results == "Error") {
                        $(".AlertChange").removeClass("alert alert-success");
                        $(".AlertChange").addClass("alert alert-danger");
                        $(".AlertChange").html(results);
                        $(".AlertChange").fadeIn('slow');
                        setTimeout(() => $(".AlertChange").fadeOut('slow'), 5000);
                    }
                    else {
                        $(".AlertChange").removeClass("alert alert-danger");
                        $(".AlertChange").addClass("alert alert-success");
                        $(".AlertChange").html('Bạn đã nạp thành công: '+Number(results).toLocaleString('en')+'VNDT');
                        $(".AlertChange").fadeIn('slow');
                        setTimeout(() => $(".AlertChange").fadeOut('slow'), 5000);
                    }
                })
                .catch(error => {
                    console.log("Error: " + error);
                });
        }
    }
</script>